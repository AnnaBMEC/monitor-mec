<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Or√ßament√°rio MEC - 2025/2026</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        .container { max-width: 1100px; margin: auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h1 { color: #003366; border-bottom: 3px solid #ffd700; padding-bottom: 10px; margin-bottom: 25px; }
        .grafico-box { background: #fff; padding: 20px; border-radius: 12px; border: 1px solid #eee; margin-bottom: 30px; height: 300px; }
        .links-rapidos { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 30px; }
        .btn { padding: 12px 20px; border-radius: 8px; text-decoration: none; color: white; font-weight: bold; font-size: 0.85rem; transition: 0.3s; border: none; cursor: pointer; display: inline-block; }
        .btn-sei { background: #721c24; }
        .btn-siop { background: #155724; }
        .busca-bloco { background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 5px solid #004a8d; }
        input { padding: 10px; border: 1px solid #ddd; border-radius: 8px; width: 100%; box-sizing: border-box; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #003366; color: white; padding: 12px; text-align: left; position: sticky; top: 0; }
        td { padding: 10px; border-bottom: 1px solid #eee; vertical-align: middle; }
        .foto-dep { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; border: 2px solid #004a8d; margin-right: 15px; }
        .flex-cell { display: flex; align-items: center; }
        .badge-ano { background: #ffc107; color: #000; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold; margin-left: 5px; }
    </style>
</head>
<body>

<div class="container">
    <h1>üèõÔ∏è Monitoramento de Emendas MEC</h1>

    <div class="links-rapidos">
        <a href="https://sei.mec.gov.br/" target="_blank" class="btn btn-sei">SEI MEC</a>
        <a href="https://www.siop.planejamento.gov.br/" target="_blank" class="btn btn-siop">Painel SIOP</a>
        <a href="https://portaldatransparencia.gov.br/emendas?ano=2025&orgao=26000" target="_blank" class="btn" style="background:#6c757d">Geral MEC 2025</a>
    </div>

    <div class="grafico-box">
        <canvas id="meuGrafico"></canvas>
    </div>

    <div class="busca-bloco">
        <input type="text" id="filtro" placeholder="Pesquisar Parlamentar por nome ou estado..." onkeyup="filtrarTabela()">
    </div>

    <table id="tabelaDados">
        <thead>
            <tr>
                <th>Parlamentar / Foto</th>
                <th>UF / Partido</th>
                <th>Consulta Consolidada</th>
            </tr>
        </thead>
        <tbody id="lista-corpo">
            <tr><td colspan="3" style="text-align:center">Carregando lista de parlamentares...</td></tr>
        </tbody>
    </table>
</div>

<script>
    const ORGAO = "26000";

    function renderizarGrafico() {
        const ctx = document.getElementById('meuGrafico').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Exerc√≠cio 2024', 'Exerc√≠cio 2025', 'Exerc√≠cio 2026'],
                datasets: [{
                    label: 'Volume de Emendas MEC (Tend√™ncia)',
                    data: [12, 15, 4], // Valores baseados em m√©dia de bilh√µes
                    backgroundColor: ['#34495e', '#3498db', '#f1c40f']
                }]
            },
            options: { maintainAspectRatio: false, responsive: true }
        });
    }

    async function carregarParlamentares() {
        try {
            const res = await fetch("https://dadosabertos.camara.leg.br/api/v2/deputados?ordem=ASC&ordenarPor=nome");
            const json = await res.json();
            const tbody = document.getElementById('lista-corpo');
            tbody.innerHTML = '';

            json.dados.forEach(d => {
                // LINK ATUALIZADO PARA 2025 para confer√™ncia de dados reais
                const url2025 = `https://portaldatransparencia.gov.br/emendas?ano=2025&orgao=${ORGAO}&nomeParlamentar=${encodeURIComponent('"' + d.nome + '"')}`;
                
                tbody.innerHTML += `
                    <tr>
                        <td>
                            <div class="flex-cell">
                                <img src="${d.urlFoto}" class="foto-dep" loading="lazy">
                                <strong>${d.nome}</strong>
                            </div>
                        </td>
                        <td>${d.siglaUf} / ${d.siglaPartido}</td>
                        <td>
                            <a href="${url2025}" target="_blank" style="color:#004a8d; font-weight:bold; text-decoration:none;">üîé Ver Emendas 2025 <span class="badge-ano">BASE REAL</span></a>
                        </td>
                    </tr>`;
            });
        } catch (e) {
            console.error("Erro ao carregar lista", e);
        }
    }

    function filtrarTabela() {
        const val = document.getElementById("filtro").value.toUpperCase();
        const rows = document.querySelectorAll("#lista-corpo tr");
        rows.forEach(r => r.style.display = r.innerText.toUpperCase().includes(val) ? "" : "none");
    }

    window.onload = () => {
        renderizarGrafico();
        carregarParlamentares();
    };
</script>
</body>
</html>
